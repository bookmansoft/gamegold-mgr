# 调测随笔

## 众筹的发布和审核

Q: 提交一个众筹审核后，点击详情，看不到正确的内容
A: 历史数据问题，已清理历史数据，重新测试时表现正常

Q: 原有的审核流程，客户端先从服务器查询条目，再将更新字段与查询结果合并提交到服务器更新，再从本地发起主链查询，该流程包含三次C/S交互，是否合理？
A: 不合理。已修正为直接提交需要更新的字段至服务器，服务器写入数据库，再发起主链查询，将结果返回客户端，只需要提交三个字段、一次交互即可

## 凭证一手交易市场

1. 显示当前所有待售凭证

当前流程使用中台数据库缓存的众筹条目，该条目存在如下问题：
- 一个CP可能先后有多个众筹条目，除了最新的一条，其余的都已经过期
- 受当前存储结构限制，不能快速查询单个众筹条目的销售详情，所以难以快速显示每个条目的销售量和库存

因此，当前显示发布条目的方式，会让操作员难以进行有效的操作，调整如下：
- 直接使用指令 stock.offer.list 查询主链，将返回的结果列表显示

2. 提供模拟页面，实现一手凭证的购买

3. 查看一手凭证销售详情页面

4. 正确显示一手交易记录列表

## 关于数据仓库

现有代码中，没有正确理解 redux 的编程思路，表现在：

1. 为每个页面单独设立 model

这么做的后果，就是数据仓库被人为分割成以URL为标记的数据孤岛，缺乏数据视图应有的整体感，打乱了数据视图应有的合理组织形式

2. 查询结果不做缓存

这会导致客户端频繁向服务端请求数据，哪怕该数据刚从服务端下发过。

**程序整体上缺失React应用应有的统一数据仓库、数据缓存和去重、Render等概念的贯彻实施，仅仅利用了单页应用在视觉效果层面的页面免刷新能力(local router)，但编程思想还是服务端渲染的旧有思维模式**